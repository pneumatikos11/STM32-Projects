Credits to https://gist.github.com/jimsynz/766994. It was modified for STM32CubeIDE
